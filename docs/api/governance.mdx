---
title: "Governance API"
description: "Endpoints for on-chain token-weighted governance proposals, vote locking, and token unlocking."
icon: "vote-yea"
---

FlowGuard governance uses token-locked voting. Voters lock CashTokens into a vote-lock covenant for the duration of the voting period. After voting ends, they unlock and reclaim their tokens.

## List Vault Proposals

```http
GET /api/vaults/:vaultId/governance?status=ACTIVE
```

Returns all governance proposals for the vault. Optionally filter by `status`.

## Create Proposal

```http
POST /api/vaults/:vaultId/governance
x-user-address: bitcoincash:q...

{
  "title": "Increase executor reward to 0.01 BCH",
  "description": "Full rationale here",
  "quorum": 1000,
  "votingDurationDays": 7
}
```

Creates a proposal with `status: ACTIVE`. Voting opens immediately and closes after `votingDurationDays`.

**Response** â€” `201`
```json
{
  "id": "...",
  "vaultId": "hex32",
  "title": "...",
  "status": "ACTIVE",
  "votesFor": 0,
  "votesAgainst": 0,
  "votesAbstain": 0,
  "quorum": 1000,
  "votingEndsAt": "2026-03-03T00:00:00Z"
}
```

## Get Proposal

```http
GET /api/governance/:proposalId
```

Returns the proposal with full vote breakdown (all `governance_votes` rows).

## Cast Off-chain Vote

```http
POST /api/governance/:proposalId/vote
x-user-address: bitcoincash:q...

{
  "vote": "FOR",
  "weight": 500
}
```

Records a lightweight off-chain vote and updates the tally. Valid values: `FOR`, `AGAINST`, `ABSTAIN`.

<Note>
For the full on-chain token-lock flow, use `/lock` and `/confirm-lock` instead.
</Note>

## Lock Tokens (On-chain Vote)

```http
POST /api/governance/:proposalId/lock

{
  "voterAddress": "bitcoincash:qr...",
  "voteChoice": "FOR",
  "stakeAmount": 1000,
  "tokenCategory": "hex32"
}
```

Deploys a VoteLockCovenant and returns a `wcTransaction` for the voter to sign and fund with their CashTokens.

**Response**
```json
{
  "success": true,
  "deployment": {
    "contractAddress": "bitcoincash:p...",
    "voteId": "hex32",
    "constructorParams": [...],
    "initialCommitment": "hex..."
  },
  "wcTransaction": { ... }
}
```

## Confirm Lock

```http
POST /api/governance/:proposalId/confirm-lock

{
  "voterAddress": "bitcoincash:q...",
  "voteChoice": "FOR",
  "weight": 1000,
  "txHash": "hex64",
  "contractAddress": "bitcoincash:p...",
  "voteId": "hex32",
  "constructorParams": [...],
  "nftCommitment": "hex..."
}
```

Verifies the vote-lock covenant output on-chain, records the vote in the database, and updates the tally.

## Unlock Tokens

```http
POST /api/governance/:proposalId/unlock

{
  "voterAddress": "bitcoincash:q...",
  "tokenCategory": "hex32"
}
```

Builds the unlock `wcTransaction` after the voting period ends. Uses the stored `contract_address` and `constructor_params` from the voter's lock record.

**Response**
```json
{
  "success": true,
  "unlockTransaction": {
    "unlockedAmount": 1000,
    "wcTransaction": { ... }
  }
}
```

## Confirm Unlock

```http
POST /api/governance/:proposalId/confirm-unlock

{
  "voterAddress": "bitcoincash:q...",
  "txHash": "hex64"
}
```

Verifies the voter received their tokens back and marks the unlock complete.
